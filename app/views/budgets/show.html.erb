<% content_for :title, "Budget" %>

<% content_for :breadcrumbs do %>
  <%= ui_breadcrumbs do %>
    <%= ui_breadcrumb_first "Records" %>
    <%= ui_breadcrumb_item "Budgets", budgets_path %>
  <% end %>
<% end %>

<div class="max-w-md">
  <div class="flex items-center h-10 mb-6">
    <h1 class="<%= ui_title_class %>">Budget: <%= @budget.category.name %></h1>
  </div>

  <div class="<%= ui_card_class %> p-6 mb-6">
    <div class="flex justify-between items-center mb-4">
      <span class="text-sm font-medium px-2 py-1 <%= @budget.monthly? ? ui_badge_info_class : 'bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300' %>">
        <%= @budget.monthly? ? "Monthly" : "Yearly" %>
      </span>
      <% if @budget.start_date %>
        <span class="text-sm <%= ui_text_muted_class %>">Since <%= @budget.start_date.strftime("%b %Y") %></span>
      <% end %>
    </div>
    
    <div class="mb-4">
      <p class="text-sm <%= ui_text_muted_class %>">Budget</p>
      <p class="text-2xl font-bold <%= ui_text_class %>"><%= format_currency(@budget.amount) %> <%= @budget.period_label %></p>
    </div>
    
    <div class="mb-4">
      <p class="text-sm <%= ui_text_muted_class %>">Spent (<%= @budget.monthly? ? "#{Date::MONTHNAMES[@month]} #{@year}" : @year %>)</p>
      <p class="text-2xl font-bold <%= ui_negative_class %>"><%= format_currency(@budget.spent(@year, @month)) %></p>
    </div>
    
    <div class="<%= ui_progress_track_lg_class %> mb-2">
      <% percentage = [@budget.percentage_used(@year, @month), 100].min %>
      <div class="<%= ui_progress_bar_lg_class(@budget.percentage_used(@year, @month)) %>" style="width: <%= percentage %>%"></div>
    </div>
    
    <% remaining = @budget.remaining(@year, @month) %>
    <p class="text-sm <%= remaining >= 0 ? ui_positive_class : ui_negative_class %>">
      <%= remaining >= 0 ? "#{format_currency(remaining)} remaining" : "#{format_currency(remaining.abs)} over budget" %>
      (<%= @budget.percentage_used(@year, @month) %>%)
    </p>
  </div>

  <div class="flex space-x-4">
    <%= link_to "Edit", edit_budget_path(@budget), class: ui_btn_primary_class %>
    <%= button_to "Delete", @budget, method: :delete, class: "#{ui_btn_danger_class} cursor-pointer", data: { turbo_confirm: "Are you sure?" } %>
  </div>
</div>
