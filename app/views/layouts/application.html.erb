<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Balance" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Balance">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-50 min-h-screen">
    <!-- Desktop sidebar -->
    <aside class="hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0 bg-slate-800 text-white">
      <div class="flex items-center h-16 px-4 border-b border-slate-700">
        <h1 class="text-xl font-bold">ğŸ’° Balance</h1>
      </div>
      <nav class="flex-1 px-2 py-4 space-y-1">
        <%= link_to "Dashboard", root_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 #{request.path == root_path ? 'bg-slate-700' : ''}" %>
        <%= link_to "Accounts", accounts_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 #{request.path.start_with?('/accounts') ? 'bg-slate-700' : ''}" %>
        <%= link_to "Assets", assets_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 #{request.path.start_with?('/assets') ? 'bg-slate-700' : ''}" %>
        <%= link_to "Transactions", transactions_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 #{request.path.start_with?('/transactions') ? 'bg-slate-700' : ''}" %>
        <%= link_to "Budgets", budgets_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 #{request.path.start_with?('/budgets') ? 'bg-slate-700' : ''}" %>
        <div class="pt-4 mt-4 border-t border-slate-700">
          <span class="px-4 text-xs font-semibold text-slate-400 uppercase">Admin</span>
          <%= link_to "Currencies", admin_currencies_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 text-sm #{request.path.start_with?('/admin/currencies') ? 'bg-slate-700' : ''}" %>
          <%= link_to "Account Types", admin_account_types_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 text-sm #{request.path.start_with?('/admin/account_types') ? 'bg-slate-700' : ''}" %>
          <%= link_to "Asset Types", admin_asset_types_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 text-sm #{request.path.start_with?('/admin/asset_types') ? 'bg-slate-700' : ''}" %>
          <%= link_to "Categories", admin_categories_path, class: "flex items-center px-4 py-2 rounded-lg hover:bg-slate-700 text-sm #{request.path.start_with?('/admin/categories') ? 'bg-slate-700' : ''}" %>
        </div>
      </nav>
    </aside>

    <!-- Mobile header -->
    <header class="md:hidden fixed top-0 left-0 right-0 bg-slate-800 text-white z-50">
      <div class="flex items-center justify-between h-14 px-4">
        <h1 class="text-lg font-bold">ğŸ’° Balance</h1>
      </div>
    </header>

    <!-- Main content -->
    <main class="md:ml-64 pt-14 md:pt-0 pb-20 md:pb-4">
      <div class="p-4 md:p-6">
        <% if notice.present? %>
          <div class="mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
            <%= notice %>
          </div>
        <% end %>
        <% if alert.present? %>
          <div class="mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
            <%= alert %>
          </div>
        <% end %>
        <%= yield %>
      </div>
    </main>

    <!-- Mobile bottom navigation -->
    <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50">
      <div class="flex justify-around py-2">
        <%= link_to root_path, class: "flex flex-col items-center px-3 py-1 #{request.path == root_path ? 'text-blue-600' : 'text-gray-500'}" do %>
          <span class="text-xl">ğŸ“Š</span>
          <span class="text-xs">Home</span>
        <% end %>
        <%= link_to accounts_path, class: "flex flex-col items-center px-3 py-1 #{request.path.start_with?('/accounts') ? 'text-blue-600' : 'text-gray-500'}" do %>
          <span class="text-xl">ğŸ¦</span>
          <span class="text-xs">Accounts</span>
        <% end %>
        <%= link_to transactions_path, class: "flex flex-col items-center px-3 py-1 #{request.path.start_with?('/transactions') ? 'text-blue-600' : 'text-gray-500'}" do %>
          <span class="text-xl">ğŸ’¸</span>
          <span class="text-xs">Transactions</span>
        <% end %>
        <%= link_to budgets_path, class: "flex flex-col items-center px-3 py-1 #{request.path.start_with?('/budgets') ? 'text-blue-600' : 'text-gray-500'}" do %>
          <span class="text-xl">ğŸ“ˆ</span>
          <span class="text-xs">Budgets</span>
        <% end %>
        <%= link_to admin_currencies_path, class: "flex flex-col items-center px-3 py-1 #{request.path.start_with?('/admin') ? 'text-blue-600' : 'text-gray-500'}" do %>
          <span class="text-xl">âš™ï¸</span>
          <span class="text-xs">Admin</span>
        <% end %>
      </div>
    </nav>
  </body>
</html>
